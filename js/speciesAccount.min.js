var appendCountryLayerToMap,baseQuery,fetchIucnRange,gMapsConfig,initMap,worldPoliticalFusionTableId,indexOf=[].indexOf||function(n){for(var e=0,o=this.length;e<o;e++)if(e in this&&this[e]===n)return e;return-1};gMapsConfig={jsApiKey:"AIzaSyC_qZqVvNk6A6px4Q7BJQOOHqpnQNihSBA",jsApiSrc:"https://maps.googleapis.com/maps/api/js",jsApiInitCallbackFn:null,hasRunInitMap:!1},isNull(window.gMapsLocalKey)||(gMapsConfig.jsApiKey=window.gMapsLocalKey),baseQuery={query:{select:"json_4326",from:worldPoliticalFusionTableId="1uKyspg-HkChMIntZ0N376lMpRzduIjr85UYPpQ"},styles:[{polygonOptions:{fillColor:"#rrggbb",strokeColor:"#rrggbb",strokeWeight:"int",fillOpacity:0}}]},appendCountryLayerToMap=function(n,e){var o,a,i,t,l,s,p,r,u,g,c,f,d;if(null==n&&(n={code:"US"}),null==e&&(e=gMapsConfig.map),null==("undefined"!=typeof google&&null!==google?google.maps:void 0))return initMap(function(){return appendCountryLayerToMap(n,e),!1}),!1;if(!(e instanceof google.maps.Map))return console.error("Invalid map object provided"),!1;if(i={code:"postal",postal:"postal",name:"name",country:"name"},t=baseQuery,"object"==typeof n){o=[];for(a in n)if(d=n[a],indexOf.call(Object.keys(i),a)>=0)if(isArray(d))for(l=0,r=d.length;l<r;l++)c=d[l],o.push("'"+i[a]+"' = '"+c+"'");else o.push("'"+i[a]+"' = '"+d+"'");for(s=0,u=o.length;s<u;s++)f={where:o[s],polygonOptions:{fillOpacity:.5}},t.styles.push(f)}else g=n,t.query.where=g;return(p=new google.maps.FusionTablesLayer(t)).setMap(e),{fusionQuery:t,layer:p,mapObj:e}},initMap=function(n,e){var o,a,i,t,l,s,p,r,u,g,c;return null==e&&(e="#species-note"),!0===gMapsConfig.hasRunInitMap?(console.debug("Map already initialized"),"function"==typeof n&&n(),!1):null==("undefined"!=typeof google&&null!==google?google.maps:void 0)?(console.debug("Loading Google Maps first ..."),l=gMapsConfig.jsApiSrc+"?key="+gMapsConfig.jsApiKey,"function"==typeof gMapsConfig.jsApiInitCallbackFn&&(s=[this.getName(),"initMap"],p=gMapsConfig.jsApiInitCallbackFn.getName(),indexOf.call(s,p)<0&&(l+="&callback="+gMapsConfig.jsApiInitCallbackFn.getName())),loadJS(l,function(){return initMap(n,e),!1}),!1):$(e).exists()?($(e).removeClass("col-xs-12").addClass("col-xs-6"),o='<div id="taxon-range-map-container" class="col-xs-6 map-container google-map-container">\n  <div id="taxon-range-map" class="map google-map">\n  </div>\n</div>',$(e).after(o),i={center:{lat:null!=(r=null!=(u=window.locationData)?u.lat:void 0)?r:0,lng:null!=(g=null!=(c=window.locationData)?c.lng:void 0)?g:0},zoom:2},t=$("#taxon-range-map").get(0),a=new google.maps.Map(t,i),gMapsConfig.map=a,gMapsConfig.hasRunInitMap=!0,"function"==typeof n&&n(),a):(console.error("Invalid page layout to init map"),!1)},fetchIucnRange=function(n){var e;return null==n&&(n=window._activeTaxon),isNull(n.genus)||isNull(n.species),e={action:"iucn",taxon:n.genus.toTitleCase()+"%20"+n.species,iucn_endpoint:"species/countries/name/"},isNull(n.subspecies)||(e.taxon+="%20"+n.subspecies),$.get("api.php",buildQuery(e,"json")).done(function(n){var o,a,i,t,l,s,p,r,u,g;if(console.log("Got",n),!0!==n.status)return console.warn(uri.urlString+"api.php?"+buildQuery(e)),!1;if(o=[],(null!=(u=n.response)?u.count:void 0)<=0)return console.warn("No results found!"),!1;for(i=[],t=0,s=(g=Object.toArray(n.response.result)).length;t<s;t++)-1===(a=g[t]).presence.search(/extinct/i)&&i.push(a);if(0===i.length)return console.warn("This taxon '"+n.response.name+"' is extinct :("),!1;for(l=0,p=i.length;l<p;l++)a=i[l],o.push(a.code);return r={code:o},console.debug("Taxon exists in "+o.length+" countries...",o),initMap(function(){var n;return console.debug("Map initialized, populating..."),n=appendCountryLayerToMap(r),console.debug("Country layers topped",n)}),!1}).fail(function(n,e){return!1}),!1},$(function(){return fetchIucnRange(),!1});
//# sourceMappingURL=speciesAccount.min.js.map