var getChartKeys,getRandomDataColor,renderTaxonData,updateTaxonomySort,modulo=function(a,b){return(+a%(b=+b)+b)%b};getRandomDataColor=function(){var a;return a="rgba("+randomInt(0,255)+","+randomInt(0,255)+","+randomInt(0,255),{border:a+",1)",background:a+",0.2)"}},updateTaxonomySort=function(){var a,b,c,d;d=Date.now(),startLoad(),a={action:"taxonomy"};try{b=p$("#default-sort-toggle").checked}catch(a){b=!0}return b||(c=getChartKeys(),a.order_sort=c.order_sort,a.genus_sort=c.genus_sort),$.get(uri.urlString+"api.php",objToArgs(a,"json")).done(function(a){var b;return!0===a.status&&(window.hlTaxonLabels=Object.toArray(a.taxonomy.order.labels),window.hlTaxonData=Object.toArray(a.taxonomy.order.data),window.genusData=a.taxonomy.genus.data,b=Date.now()-d,console.debug("Taxon data fetch successful in "+b+"ms"),renderTaxonData.debounce(),stopLoad()),!1}).fail(function(a,b){return console.error(a,b),stopLoadError("There was an error updating the sort of your dataset"),!1}),!1},renderTaxonData=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m;null!=("undefined"!=typeof _asm&&null!==_asm?_asm.chart:void 0)&&_asm.chart.destroy(),l=function(a,b,c){return 0===modulo(b,4)&&toFloat(a.noExponents())>=1?a.noExponents():""};try{p$("#log-scale").checked?m="logarithmic":(m="linear",l=void 0)}catch(a){m="logarithmic"}if($("#high-level-taxon-data").exists()){for(console.log("Rendering high level taxon data"),g=Object.toArray(window.hlTaxonLabels),f=Object.toArray(window.hlTaxonData),d=[],h=0,i=g.length;h<i;h++)k=g[h],e=Object.toArray(window.genusData[k].labels),d.push(e.length);c=getRandomDataColor(),j=getRandomDataColor(),a={type:"bar",data:{labels:g,datasets:[{label:"Species Count",type:"bar",data:f,borderColor:c.border,backgroundColor:c.background,borderWidth:1},{label:"Genus Count",type:"line",data:d,borderColor:j.border,backgroundColor:j.background,borderWidth:1}]},options:{scales:{yAxes:[{type:m,scaleLabel:{labelString:"Species",display:!0},ticks:{min:.75}}],xAxes:[{scaleLabel:{labelString:"Linnean Order",display:!0}}]}}},null!=l&&(a.options.scales.yAxes[0].ticks.callback=l),b=$("#high-level-chart"),"object"!=typeof window._asm&&(window._asm={}),_asm.chart=new Chart(b,a),console.debug("Config:",a),b.click(function(a){var b,d,e,f,g,h,i,j;return d=_asm.chart.getDatasetAtEvent(a),f=_asm.chart.getElementAtEvent(a),console.debug("Dataset",d),console.debug("Element",f),e=f[0]._index,b=d[e],console.debug("Specific data:",b),g=b._model.label,console.debug("Taxon clicked:",g),h=window.genusData[g],console.debug("Using data",h),$("#zoom-taxon-label").html("<span class='genus'>"+g+"</span> Genus Breakdown"),c=getRandomDataColor(),i={type:"bar",data:{labels:Object.toArray(h.labels),datasets:[{label:"Species Count",data:Object.toArray(h.data),borderColor:c.border,backgroundColor:c.background,borderWidth:1}]},options:{scales:{yAxes:[{type:m,scaleLabel:{labelString:"Species",display:!0},ticks:{min:.75}}],xAxes:[{scaleLabel:{labelString:"Genera in "+g,display:!0},ticks:{fontStyle:"italic"}}]}}},null!=l&&(i.options.scales.yAxes[0].ticks.callback=l),j=$("#taxon-zoom-chart"),null!=_asm.zoomChart&&_asm.zoomChart.destroy(),_asm.zoomChart=new Chart(j,i),!1})}return!1},getChartKeys=function(){var a,b,c,d,e,f,g;for(a={},g=$(".chart-param"),c=0,e=g.length;c<e;c++){f=g[c],d=$(f).attr("data-key");try{if(null==p$(f).checked)throw"Not Toggle";a[d]=p$(f).checked}catch(c){try{window.debugDrop||(window.debugDrop={}),console.log("Looking at",f),window.debugDrop[d]=f}catch(a){}try{b=$(p$(f).selectedItem).attr("data-value")}catch(a){}a[d]=null!=b?b:p$(f).selectedItemLabel.toLowerCase().replace(" ","-")}}return a},$(function(){var a;_asm.hasBoundDropdowns=!1,renderTaxonData();try{$("#log-scale").on("iron-change",function(){return null!=("undefined"!=typeof _asm&&null!==_asm?_asm.chart:void 0)&&_asm.chart.destroy(),renderTaxonData.debounce(),!1}),$("#default-sort-toggle").on("iron-change",function(){var a,b,c,d,e,f,g;if(p$(this).checked)try{for(f=$(".sort-options"),b=0,d=f.length;b<d;b++)a=f[b],p$(a).disabled=!0}catch(a){$(".sort-options").attr("disabled","disabled")}else try{for(g=$(".sort-options"),c=0,e=g.length;c<e;c++)a=g[c],p$(a).disabled=!1}catch(a){$(".sort-options").removeAttr("disabled")}return renderTaxonData.debounce(),!1})}catch(a){}try{return delayPolymerBind("paper-dropdown-menu#order-sort",function(){var a;return _asm.hasBoundDropdowns||(_asm.hasBoundDropdowns=!0,console.info("Binding events for dropdown"),a=function(a,b){var c,d,e,f;return console.debug(a,b,b.detail.item),d="paper-dropdown-menu"!==a.tagName.toLowerCase()?$(a).parents("paper-dropdown-menu").get(0):a,e="paper-item"!==a.tagName.toLowerCase()?null!=(f=b.detail.item)?f:$(a).find("paper-item").get(0):a,console.debug(d,e),p$(d)._setSelectedItem(e),c=getChartKeys(),console.debug(c),updateTaxonomySort(),!1},$("paper-dropdown-menu.sort-options paper-listbox").on("iron-select",function(b){return console.debug("is event for dropdown"),a.debounce(50,null,null,this,b),!1}),$("paper-dropdown-menu.sort-options paper-listbox paper-item").click(function(b){return console.debug("Click event for dropdown"),a.debounce(50,null,null,this,b),!1}),console.log("Events bound")),!1})}catch(b){return a=b,console.warn("Warning: couldn't bind polymer events - "+a.message),console.warn(a.stack)}});
//# sourceMappingURL=charts.min.js.map