var getChartKeys,getRandomDataColor,renderTaxonData,updateTaxonomySort,modulo=function(e,o){return(+e%(o=+o)+o)%o};getRandomDataColor=function(){var e;return e="rgba("+randomInt(0,255)+","+randomInt(0,255)+","+randomInt(0,255),{border:e+",1)",background:e+",0.2)"}},updateTaxonomySort=function(){var e,o,a,t;t=Date.now(),startLoad(),e={action:"taxonomy"};try{o=p$("#default-sort-toggle").checked}catch(e){o=!0}return o||(a=getChartKeys(),e.order_sort=a.order_sort,e.genus_sort=a.genus_sort),$.get(uri.urlString+"api.php",objToArgs(e,"json")).done(function(e){var o;return!0===e.status&&(window.hlTaxonLabels=Object.toArray(e.taxonomy.order.labels),window.hlTaxonData=Object.toArray(e.taxonomy.order.data),window.genusData=e.taxonomy.genus.data,o=Date.now()-t,console.debug("Taxon data fetch successful in "+o+"ms"),renderTaxonData.debounce(),stopLoad()),!1}).fail(function(e,o){return console.error(e,o),stopLoadError("There was an error updating the sort of your dataset"),!1}),!1},renderTaxonData=function(){var e,o,a,t,n,r,s,l,d,c,i,u,p;null!=("undefined"!=typeof _asm&&null!==_asm?_asm.chart:void 0)&&_asm.chart.destroy(),u=function(e,o,a){return 0===modulo(o,4)&&toFloat(e.removeExponents())>=1?e.removeExponents():""};try{p$("#log-scale").checked?p="logarithmic":(p="linear",u=void 0)}catch(e){p="logarithmic"}if($("#high-level-taxon-data").exists()){for(console.log("Rendering high level taxon data"),s=Object.toArray(window.hlTaxonLabels),r=Object.toArray(window.hlTaxonData),t=[],l=0,d=s.length;l<d;l++)i=s[l],n=Object.toArray(window.genusData[i].labels),t.push(n.length);a=getRandomDataColor(),c=getRandomDataColor(),e={type:"bar",data:{labels:s,datasets:[{label:"Species Count",type:"bar",data:r,borderColor:a.border,backgroundColor:a.background,borderWidth:1},{label:"Genus Count",type:"bar",data:t,borderColor:c.border,backgroundColor:c.background,borderWidth:1}]},options:{scales:{yAxes:[{type:p,scaleLabel:{labelString:"Species",display:!0},ticks:{min:.75}}],xAxes:[{scaleLabel:{labelString:"Linnean Order",display:!0}}]}}},null!=u&&(e.options.scales.yAxes[0].ticks.callback=u),o=$("#high-level-chart"),"object"!=typeof window._asm&&(window._asm={}),_asm.chart=new Chart(o,e),console.debug("Config:",e),o.click(function(e){var o,t,n,r,s,l,d,c;return t=_asm.chart.getDatasetAtEvent(e),r=_asm.chart.getElementAtEvent(e),console.debug("Dataset",t),console.debug("Element",r),n=r[0]._index,o=t[n],console.debug("Specific data:",o),s=o._model.label,console.debug("Taxon clicked:",s),l=window.genusData[s],console.debug("Using data",l),$("#zoom-taxon-label").html("<span class='genus'>"+s+"</span> Genus Breakdown"),a=getRandomDataColor(),d={type:"bar",data:{labels:Object.toArray(l.labels),datasets:[{label:"Species Count",data:Object.toArray(l.data),borderColor:a.border,backgroundColor:a.background,borderWidth:1}]},options:{scales:{yAxes:[{type:p,scaleLabel:{labelString:"Species",display:!0},ticks:{min:.75}}],xAxes:[{scaleLabel:{labelString:"Genera in "+s,display:!0},ticks:{fontStyle:"italic"}}]}}},null!=u&&(d.options.scales.yAxes[0].ticks.callback=u),c=$("#taxon-zoom-chart"),null!=_asm.zoomChart&&_asm.zoomChart.destroy(),_asm.zoomChart=new Chart(c,d),!1})}return!1},getChartKeys=function(){var e,o,a,t,n,r,s;for(e={},a=0,n=(s=$(".chart-param")).length;a<n;a++){r=s[a],t=$(r).attr("data-key");try{if(null==p$(r).checked)throw"Not Toggle";e[t]=p$(r).checked}catch(a){try{window.debugDrop||(window.debugDrop={}),console.log("Looking at",r),window.debugDrop[t]=r}catch(e){}try{o=$(p$(r).selectedItem).attr("data-value")}catch(e){}e[t]=null!=o?o:p$(r).selectedItemLabel.toLowerCase().replace(" ","-")}}return e},$(function(){var e;_asm.hasBoundDropdowns=!1,renderTaxonData();try{$("#log-scale").on("iron-change",function(){return null!=("undefined"!=typeof _asm&&null!==_asm?_asm.chart:void 0)&&_asm.chart.destroy(),renderTaxonData.debounce(),!1}),$("#default-sort-toggle").on("iron-change",function(){var e,o,a,t,n,r,s;if(p$(this).checked)try{for(o=0,t=(r=$(".sort-options")).length;o<t;o++)e=r[o],p$(e).disabled=!0}catch(e){$(".sort-options").attr("disabled","disabled")}else try{for(a=0,n=(s=$(".sort-options")).length;a<n;a++)e=s[a],p$(e).disabled=!1}catch(e){$(".sort-options").removeAttr("disabled")}return renderTaxonData.debounce(),!1})}catch(e){}try{return delayPolymerBind("paper-dropdown-menu#order-sort",function(){var e;return _asm.hasBoundDropdowns||(_asm.hasBoundDropdowns=!0,console.info("Binding events for dropdown"),e=function(e,o){var a,t,n,r;return console.debug(e,o,o.detail.item),t="paper-dropdown-menu"!==e.tagName.toLowerCase()?$(e).parents("paper-dropdown-menu").get(0):e,n="paper-item"!==e.tagName.toLowerCase()?null!=(r=o.detail.item)?r:$(e).find("paper-item").get(0):e,console.debug(t,n),p$(t)._setSelectedItem(n),a=getChartKeys(),console.debug(a),updateTaxonomySort(),!1},$("paper-dropdown-menu.sort-options paper-listbox").on("iron-select",function(o){return console.debug("is event for dropdown"),e.debounce(50,null,null,this,o),!1}),$("paper-dropdown-menu.sort-options paper-listbox paper-item").click(function(o){return console.debug("Click event for dropdown"),e.debounce(50,null,null,this,o),!1}),console.log("Events bound")),!1})}catch(o){return e=o,console.warn("Warning: couldn't bind polymer events - "+e.message),console.warn(e.stack)}});
//# sourceMappingURL=charts.min.js.map